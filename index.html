<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

    <!--google fonts-->
    <link href="https://fonts.googleapis.com/css2?family=Langar&display=swap" rel="stylesheet">

    <!--font awesome link-->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <!--title name/icon-->
    <title>Weather App</title>
    <link rel="icon" href="./Assets/icon.png" type='image/icon'>

    <!--style-->
    <style>
    body{
    /*background-color: skyblue;*/
    background: skyblue ;
    font-family: 'Langar', cursive;
    background-size: cover;
    background-repeat: no-repeat;
    background-attachment: fixed;
    font-variant: small-caps;
    font-weight: bold;
    }

    #header{
    margin-top: 50px;
    text-align: center;
    align-items: center;
    justify-content: center;
    }

    #header h2{
    font-weight: bold;
    text-decoration: underline ;
    color: #fff;
    }

    .card{
    border: 1px solid transparent;
    border-radius: 20px;
    background-color: rgba(245, 245, 245, 0.4);
    box-shadow: 2px 2px 2px grey;
    }

    .inputcity{
    background-color: transparent;
    }

    .location{
    font-size: larger;
    }

    .date{
    font-size: small;
    }
    
    .temp{
    font-size: 6vh;
    }

    .weather{
    font-size: x-large;
    }
    #footer{
      background-color: rgba(245, 245, 245, 0.4);
      position: fixed;
      bottom: 0;
      width: 100%;
      border-radius: 100px;
    }
    </style>

  </head>
  <body>
      <!--heading section -->
      <section id ='header'>
        <div class="container ">
            <h2>Weather App</h2>
        </div>
      </section>
      <!--heading section end-->

      <!--app section -->
      <section id='app-card '>
          <div class="container ">
            <div class="row justify-content-center">
                <div class="card text-center align-items-center" style="width: 18rem;">
                    <img src="./Assets/icon.png" class="img-fluid" width='200px' id='app-icon' alt="weather app icon">
                    <div class="card-body">
                        <input type="text" class="inputcity" id='inputcityid' placeholder="Enter City Name...">
                    </div>
                    <div class="mb-2">
                        <div class="m-auto">
                            <div class="location" id="city"></div>
                            <div class="date" id="date"></div>
                        </div>
                        <div class="m-auto">
                            <div class='temp' id="temp"></div>
                            <span><img src='' id="wicon"></span><span class="weather" id='weather'></span>
                        </div>
                    </div>
                  </div>
            </div>
          </div>
      </section>
      <!--app section end-->

      <!--footer-->
      <footer id='footer' >
        <div class="text-center ">
          <i class="fa fa-copyright" aria-hidden="true"> <script>document.write(new Date().getFullYear());</script> | All rights reserved</i><br>
          <p>Designed with <i class="fa fa-heart" aria-hidden="true" style="color: red;"></i> by <a href="https://arwazkhan.me/" target="_blank" style="color: black;">Arwaz Khan</a></p>
        </div>
      </footer>
      <!--footer end-->

    <!--app js-->
    <script> 
      //Api details
        const weatherApi = {
            key : "75816751e6b891f08181f25c7f69e532",
            baseUrl : "https://api.openweathermap.org/data/2.5/weather"
        };
        //getting city name from user
        const inputcity = document.getElementById('inputcityid');
        inputcity.addEventListener('keypress',(event) =>{
            if(event.keyCode==13){
            getweatherreport(inputcity.value); //calling function
            }
        });
        // fetching details from openweather API
        function getweatherreport(cityname){
            fetch(`${weatherApi.baseUrl}?q=${cityname}&appid=${weatherApi.key}&units=metric`)
            .then(weather =>{
                return weather.json();
            }).then(showweatherreport);
        }
        //Showing details on screen
        function showweatherreport(weather){
            let cityname = document.getElementById('city');
            cityname.innerText= `${weather.name}, ${weather.sys.country}`;

            let temperature = document.getElementById('temp');
            temperature.innerHTML = `${Math.round(weather.main.temp)}&deg;C`;

            let weathertype = document.getElementById('weather');
            weathertype.innerText=`${weather.weather[0].main}`;
            
            let ddate= document.getElementById('date');
            var nowDate = new Date(); 
            var date = nowDate.getDate()+'/'+(nowDate.getMonth()+1)+'/'+nowDate.getFullYear(); 
            ddate.innerText=`${date}`;
            
            let weathericon = document.getElementById('wicon'); 
            iconurl='http://openweathermap.org/img/wn/';
            idicon=`${weather.icon}`;
            source=`${iconurl}${weather.weather[0].icon}.png`;
            weathericon.setAttribute("src",source);

            if (weathertype.textContent=='Clear'){
              document.body.style.backgroundImage="url('./Assets/clear.jpg')";
            }
            else if(weathertype.textContent=='Thunderstorm'){
              document.body.style.backgroundImage="url('./Assets/thunderstrom.jpg')";
            }
            else if(weathertype.textContent=='Snow'){
              document.body.style.backgroundImage="url('./Assets/snow.jpg')";
            }
            else if(weathertype.textContent=='Clouds'){
              document.body.style.backgroundImage="url('./Assets/clouds.jpg')";
            }
            else if(weathertype.textContent=='Rain'){
              document.body.style.backgroundImage="url('./Assets/rain.jpg')";
            }
            else if(weathertype.textContent=='Drizzle'){
              document.body.style.backgroundImage="url('./Assets/drizzle.jpg')";
            }
            else {
              document.body.style.backgroundImage="url('./Assets/atmosphere.jpg')";
            }
        }

        //changing app icon in night
        let nicon = document.getElementById('app-icon');
        var hrs = [19,20,21,22,23,00,01,02,03,04,05];  //night icon 7pm to 5pm
        var d = new Date();
        var n = d.getHours();
        if (hrs.includes(n)){
          nicon.setAttribute("src",`./Assets/icon-night.png`);
        }else{
          nicon.setAttribute("src","./Assets/icon.png");
        }

        //clearing input press enter and setting to default 
        const INPUT = document.getElementById('inputcityid');
          INPUT.addEventListener('keypress',(event) =>{
            if(event.keyCode==13  && $(INPUT).val()==''){
              location.reload();
            }
        });
    </script>

    <!-- Option 2: jQuery, Popper.js, and Bootstrap JS-->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
  </body>
</html>
